<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    // 1.XMLHttpRequest
    // Ajax想要实现浏览器与服务器之间的异步通信，需要依靠XMLHttpRequest，他是一个构造函数

    // 2.AJAX的使用步骤
    // 2.1.创建xhr对象
    // const xhr = new XMLHttpRequest();

    // 2.2.准备发送请求
    // xhr.open('HTTP方法GET、POST、PUT、DELETE','地址URL 远程地址 本地地址','是否使用异步发送请求，true or false')
    // 调用open并不会真正发送请求，而是做好发送请求的准备工作

    // 2.3.发送请求
    // 调用send()正式发送请求
    // send()通过请求体携带数据，而get是通过请求头传递数据，如果使用GET方法，则send()不能携带任何数据
    // xhr.send(null); null是兼容性写法，部分浏览器需要写null保持兼容

    // 2.4.监听事件，处理响应
    // 当获取到响应后，会触发xhr对象的readystatechange事件，可以在该事件中对响应进行处理

    // 兼容性写法
    // HTTP状态码
    // 获取响应后，响应的内容会自动填充到xhr对象的属性
    // xhr.onreadystatechange = () => {
    //   if(xhr.readyState !== 4) return;


    //   if((xhr.status >= 200 && xhr.status < 300) || xhr === 304) {
    //     // console.log('正常使用响应数据')
    //     console.log(xhr.responseText)
    //   }
    // }
    // 非兼容性写法，IE6~IE8不兼容addEventListener
    // 为了兼容性，readystatechange中不使用this，而是直接使用xhr
    // xhr.addEventListener('readystatechange', () => {

    // }, false);

    // readystatechange事件监听readystate这个状态的变化
    // 它的值从0~4，一共5个状态
    // 0：未初始化，尚未调用open()
    // 1：启动，已经调用open()，但尚未调用send()
    // 2：发送，已经调用send()，但是尚未收到响应
    // 3：接受，已经接收到部分响应数据

    // 3.使用Ajax完成前后端通信
    // const url = 'https://www.imooc.com/api/http/search/suggest?words=js';
    // const xhr = new XMLHttpRequest();
    // xhr.onreadystatechange = () => {
    //   if(xhr.readyState !== 4) return;
    //   if((xhr.status >= 200 && xhr.status < 300) || xhr === 304) {
    //     // console.log(xhr.responseText);
    //     // console.log(typeof xhr.responseText);
    //     console.log(xhr);
    //   }
    // };
    // xhr.open('GET', url, true);
    // xhr.send(null);
    const url = './JSON/array.json';
    const xhr = new XMLHttpRequest();
    xhr.onreadystatechange = () => {
      if(xhr.readyState !== 4) return;
      if((xhr.status >= 200 && xhr.status < 300) || xhr.status === 304) {
        console.log(xhr.responseText);
      }
    };
    xhr.open('GET', url, true);
    xhr.send(null);
  </script>
</body>
</html>